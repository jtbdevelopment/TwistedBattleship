<ion-view class="createGame">
    <ion-nav-buttons side="right">
        <button class="button button-icon button-clear ion-person-add" ng-show="invitableFriends.length >= 0"
                ng-click="showInviteFriends()"></button>
        <button class="button button-icon button-clear ion-help-circled" ng-click="showHelp(0)"></button>
    </ion-nav-buttons>
    <!--  TODO - move out  -->
    <script id="help-modal.html" type="text/ng-template">
        <div class="modal">
            <!--  TODO - theme  -->
            <div class="default-theme">
                <div class="createHelp tbsModal">
                    <ion-header-bar>
                        <button class="button button-positive button-icon ion-arrow-left-b"
                                ng-click="previousHelp()"></button>
                        <h1 class="title">Help on {{featureData[helpIndex].feature.label}}</h1>
                        <button class="button button-positive button-icon ion-arrow-right-b"
                                ng-click="nextHelp()"></button>
                    </ion-header-bar>
                    <ion-content>
                        <div class="row">
                            <div class="col-100"><h4>{{featureData[helpIndex].feature.description}}</h4></div>
                        </div>
                        <div class="row" ng-repeat="option in featureData[helpIndex].options">
                            <div class="col-20">
                                <strong>{{option.label}}</strong>
                            </div>
                            <div class="col-80">
                                {{option.description}}
                            </div>
                        </div>

                        <button class="button button-full button-positive" ng-click="closeHelp()">Close</button>
                    </ion-content>
                </div>
            </div>
        </div>
    </script>
    <!--  TODO - move out  -->
    <script id="invite-modal.html" type="text/ng-template">
        <div class="modal">
            <!--  TODO - theme  -->
            <div class="default-theme">
                <div class="inviteFriends tbsModal">
                    <ion-header-bar>
                        <h1 class="title">Invite Friends!</h1>
                    </ion-header-bar>
                    <ion-content>
                        <div class="list">
                            <label class="item item-input">
                                <div class="input-label">
                                    Friends To Invite:
                                </div>
                                <!-- TODO - seems to have caching bug on first load - confirmed ion-autocomplete bug - take update -->
                                <!-- TODO - why do we need callbacks - why isn't scope working directly?  -->
                                <ion-autocomplete template-url="templates/autocompleteTemplate.html"
                                                  ng-model="friendsToInvite"
                                                  items-method="queryInvitableFriends(query)"
                                                  selected-items-label="Selected Friends:"
                                                  placeholder="Select friends..."
                                                  item-value-key="id"
                                                  item-view-value-key="name"
                                                  multiple-select="true">
                                </ion-autocomplete>
                            </label>
                        </div>
                        <button class="button button-full button-positive" ng-click="inviteFriends(friendsToInvite)">
                            Invite
                        </button>
                        <button class="button button-full" ng-click="cancelInviteFriends()">Cancel</button>
                    </ion-content>
                </div>
            </div>
        </div>
    </script>
    <ion-content>
        <div class="list create">
            <div ng-repeat="feature in featureData | propsFilter: { checkBox: 'false' }">
                <label class="item item-input item-select">
                    <div class="input-label">
                        <i class="icon optionOn ion-{{gameDetails.iconForFeature(currentOptions[feature.index])}}"></i>
                        {{feature.feature.label}}
                    </div>
                    <select ng-model="currentOptions[feature.index]">
                        <option ng-repeat="option in feature.options" value="{{option.feature}}">{{option.label}}
                        </option>
                    </select>
                </label>
            </div>

            <div ng-repeat="feature in featureData | propsFilter: { checkBox: 'true' }">
                <ion-toggle ng-model="currentOptions[feature.index]">
                    <i class="icon ion-{{gameDetails.iconForFeature(feature.options[0].feature)}} {{currentOptions[feature.index] ? 'optionOn' : 'optionOff'}}"></i>
                    {{feature.feature.label}}
                </ion-toggle>
            </div>
            <label class="item item-input">
                <div class="input-label">
                    <i class="icon optionOn ion-person-stalker"></i>
                    Opponents (Max 5):
                </div>
                <!-- TODO - seems to have caching bug on first load  -->
                <!-- TODO - why do we need callbacks - why isn't scope working directly?  -->
                <ion-autocomplete template-url="templates/autocompleteTemplate.html"
                                  ng-model="playerChoices"
                                  items-method="queryFriends(query)"
                                  selected-items-label="Selected Players:"
                                  placeholder="Select opponents..."
                                  item-value-key="md5"
                                  item-view-value-key="displayName"
                                  items-clicked-method="playersChanged(callback)"
                                  items-removed-method="playersChanged(callback)"
                                  multiple-select="true">
                </ion-autocomplete>
            </label>
        </div>
        <button class="button-full button-positive button" ng-disabled="!(submitEnabled)" ng-click="createGame()">
            Start
        </button>
    </ion-content>
</ion-view>